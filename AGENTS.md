## 1. 시스템 요약
"Follow Me!" 시스템은 복잡한 웹사이트에서 개인화된 대화형 단계별 가이드를 생성하여 사용자 경험을 향상시키는 것을 목표로 합니다. 브라우저 확장 프로그램을 통해 익명으로 사용자 상호 작용 데이터를 수집하고, 백엔드 API를 통해 이 데이터를 수집한 다음, 데이터 분석 및 머신 러닝을 수행하여 성공적인 사용자 경로와 행동을 식별함으로써 이를 달성합니다.

## 2. AGENTS.md 목록
| 문서 | 경로 | 책임 | I/O 요약 |
| :--- | :--- | :--- | :--- |
| extension | `extension/AGENTS.md` | 익명화된 사용자 클릭 데이터를 수집하고, 동의를 관리하며, 데이터를 버퍼링하고, 백엔드에 업로드합니다. | **입력:** 사용자 클릭, 동의, 설치 이벤트, 백엔드 응답. **출력:** 버퍼링된 데이터, 백엔드로의 HTTP POST. |
| server | `server/AGENTS.md` | 확장 프로그램에서 사용자 행동 로그 데이터(단일/배치)를 수신하고, 기본 유효성 검사를 수행하며, 콘솔에 기록합니다(DB 플레이스홀더). | **입력:** JSON 로그 데이터가 포함된 HTTP POST 요청. **출력:** JSON 응답(성공/오류), 콘솔 로그. |
| analysis | `analysis/AGENTS.md` | (계획됨) 사용자 상호 작용 데이터를 처리하여 클러스터와 경로를 식별하고, 가이드 생성을 알립니다. | **입력:** 처리된 사용자 상호 작용 데이터(DB에서). **출력:** 사용자 클러스터, 경로, 통찰력(DB/API로). |

## 3. 아키텍처 개요
- Agent 간의 상호작용 흐름 (텍스트 기반 시퀀스 또는 파이프라인):
    1.  사용자가 웹 페이지와 상호 작용합니다.
    2.  `extension/content.js`는 사용자 `click` 이벤트를 캡처하여(동의한 경우) `extension/background.js`로 보냅니다.
    3.  `extension/background.js`는 이러한 이벤트를 로컬에 버퍼링하고 주기적으로(알람을 통해) 이벤트 배치를 `server/app.py`의 `/api/v1/log_batch` 엔드포인트로 HTTP POST 요청으로 보냅니다.
    4.  `server/app.py`는 배치 데이터를 수신하고 기본 유효성 검사를 수행하며 현재 콘솔에 출력합니다(데이터베이스 저장용).
    5.  (계획됨) `analysis` 모듈은 데이터베이스에서 사용자 상호 작용 데이터를 검색합니다(`server`에서 구현된 후).
    6.  (계획됨) `analysis` 모듈은 이 데이터를 처리하여 사용자 클러스터와 성공적인 경로를 도출합니다.
    7.  (계획됨) `analysis` 모듈의 결과는 `extension`을 통해 사용자에게 대화형 가이드를 만들고 제공하기 위해 아직 지정되지 않은 가이드 생성 및 전달 시스템에서 사용됩니다.

- 주요 데이터 흐름:
    *   **클릭 이벤트:** 사용자 -> `extension` (콘텐츠 스크립트) -> `extension` (백그라운드 스크립트) -> HTTP POST -> `server` (API) -> (데이터베이스 - 계획됨)
    *   **동의 상태:** 사용자 -> `extension` (동의 UI) -> `chrome.storage.local` (로컬 저장소) -> `extension` (백그라운드/콘텐츠 스크립트)
    *   **분석된 데이터:** (데이터베이스 - 계획됨) -> `analysis` 모듈 -> (데이터베이스 - 계획됨, 또는 가이드 생성 시스템)

- 모듈 간 의존성 구조:
    *   `extension`은 데이터 업로드를 위해 `server` API에 의존합니다.
    *   `server`는 데이터 입력을 위해 `extension`에 의존합니다.
    *   `analysis`(계획됨)는 원시 데이터에 대해 `server`(데이터베이스를 통해)에 의존합니다.
    *   `extension`(가이드 전달을 위해 암시됨)은 `analysis` 모듈의 출력에 의존합니다.

## 4. SDLC 및 프로토타입 검토
- 코드에서 역추론된 요구사항:
    - 웹 페이지에서 익명화된 사용자 행동 데이터(클릭)를 수집합니다.
    - 데이터 수집에 대한 사용자 동의를 확보합니다.
    - 효율적인 전송을 위해 데이터를 버퍼링하고 배치 처리합니다.
    - 데이터 수집을 위한 강력한 API를 제공합니다.
    - 사용자 행동을 이해하기 위해 데이터 분석(클러스터링, 경로 분석)을 수행합니다.
    - 분석 결과를 활용하여 개인화된 사용자 가이드를 생성합니다.
- 프로토타입 특성 및 품질 이슈:
    - **중요한 데이터 영속성 격차:** `server`에는 현재 실제 데이터베이스 통합이 없어 수집된 데이터에 대한 "블랙홀"이 됩니다. 이는 시스템의 핵심 기능에 가장 중요한 누락된 부분입니다.
    - **구현되지 않은 분석 모듈:** 원시 데이터를 실행 가능한 통찰력으로 변환하는 데 필수적인 `analysis` 구성 요소가 완전히 비어 있습니다.
    - **하드코딩된 구성:** 백엔드 URL 및 서버 실행 구성이 `extension` 및 `server`에 하드코딩되어 배포 유연성을 저해합니다.
    - **잠재적 PII 유출:** `extension`은 서버로 보내기 전에 익명화 요구 사항에도 불구하고 민감한 정보를 포함할 수 있는 `textContent`를 캡처합니다.
    - **기본 UI/로깅:** `extension`(동의, 팝업) 및 `server`(콘솔 출력) 모두 UI 및 로깅에 대한 기본 프로토타입 수준 구현을 보여줍니다.
    - **보안 부족:** `server` API에 대한 인증/권한 부여가 없습니다.
    - **테스트 부재:** 모든 구성 요소에 대한 단위 또는 통합 테스트가 없어 유지 관리 위험이 크게 증가합니다.
- 전체적인 리팩터링 필요 영역:
    - **데이터 파이프라인 완료:** `server` 모듈 내에 강력한 데이터베이스 통합을 구현합니다.
    - **분석 모듈 구현:** 적절한 데이터 로딩, 처리 및 ML 알고리즘으로 `analysis` 모듈을 개발합니다.
    - **구성 관리:** 환경 변수 또는 전용 구성 메커니즘을 사용하여 모든 환경별 구성(API URL, 포트, 디버그 플래그, 데이터베이스 자격 증명)을 외부화합니다.
    - **보안 구현:** `server` API에 인증/권한 부여를 추가합니다.
    - **PII 완화:** `extension`에서 더 엄격한 PII 필터링/익명화를 재평가하고 구현하거나 명확한 데이터 수집 정책을 시행합니다.
    - **로깅 및 모니터링:** 모든 구성 요소에 걸쳐 구조화된 로깅을 구현합니다.
    - **테스트 전략:** 포괄적인 단위 및 통합 테스트를 개발하고 통합합니다.

## 5. 다음 반복 권장 사항
- 기능적 개선:
    - `server` 모듈에 데이터 저장 메커니즘을 구현합니다(예: 이벤트 로그용 MongoDB, 분석 결과용 PostgreSQL).
    - 기본 데이터 검색 및 초기 클러스터링 알고리즘에 중점을 둔 `analysis` 모듈 구현을 시작합니다.
    - `extension`의 데이터 수집을 다른 관련 사용자 상호 작용(예: 양식 제출, 페이지 탐색 이벤트)을 포함하도록 확장합니다.
- 구조 개선:
    - `extension` 및 `server`에 걸쳐 환경 변수에 대한 공유 구성 메커니즘을 도입합니다.
    - 일관성을 보장하기 위해 사용자 이벤트 및 분석 출력에 대한 데이터 스키마를 공식화합니다(예: JSON 스키마 또는 이와 유사한 것 사용).
    - 중앙 집중식 로깅 솔루션을 구현합니다.
- 테스트 보완:
    - `extension`의 백그라운드 로직 및 `server`의 API 엔드포인트에 대한 단위 테스트를 도입합니다.
    - `extension`에서 `server`로(그리고 결국 데이터베이스로)의 데이터 흐름을 확인하기 위한 통합 테스트를 계획합니다.